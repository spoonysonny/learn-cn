## 土壤湿度

一起来检测植物土壤湿度吧！

## 材料

- 1块micro:bit带电池盒和电池
- 2根长钉
- 2个鳄鱼夹

## 活动

### 设置

[https://youtu.be/S8NppVT_paw](https://youtu.be/S8NppVT_paw)

制作土壤湿度传感器，你需要进行以下操作：

- 用鳄鱼夹将长钉连接到micro:bit上3V的引脚，并将长钉插入土壤中。
- 将另一根长钉连接到P0引脚，并插入土壤中。

这就是我们的土壤湿度传感器了！

### 代码

你将用一盆干燥的土壤和一盆湿润的土壤来给你的湿度计编程。这样你就可以给micro:bit设置干燥和湿润两种情况下的条件。

#### 步骤 1： 测量湿度

![](https://i.imgur.com/W61dtOb.png)

土壤本身根据它的含水量和营养成分自带一些电阻。它的作用就像电路里面的一个可变电阻。水不能导电但是土壤的营养成分却可以。水和土壤营养成分的结合使土壤带有一些导电性能。因此，水分越多，和营养成分混合在一起，土壤的电阻越弱。

为了测量土壤的电阻，我们用`模拟读取引脚`来读取引脚**P0**处的电压。这个电压会返回一个`0` (无电流)到`1023` (最大电流)之间的值。用`绘制条形图`将数值以条形图的形式显示在micro:bit屏幕上。

![](https://i.imgur.com/V43lmPg.png)

##### 试一试吧!

- 将长钉插入干燥的泥土，你可以看到micro:bit上的大部分都熄灭了。
- 将长钉插入湿润的泥土，你可以看到micro:bit上的大部分都点亮了。

#### 步骤 2：传感器数据值

在上一个程序中，我们只是对传感器的值有了一个大概的了解。我们只是用了一个小屏幕来显示它。让我们添加一些代码使按下按钮**A**就能够显示当前的读数。

这个代码需要放入到`无限循环`积木块中。我们也添加了变量`reading`来存储读取的数值。

![](https://i.imgur.com/2KUcvx5.png)

##### 试一试吧!

- 将长钉插入干燥的泥土，按下按钮A并记录显示的数值。你可以看到的一个数值大概是在250左右。这个数值是土壤干燥情况下的数值。
- 将长钉插入湿润的泥土，按下按钮A并记录显示的数值。你可以看到的一个数值大概是在1000左右。这个数值是土壤湿润情况下的数值。

[https://youtu.be/S8NppVT_paw](https://youtu.be/S8NppVT_paw)

#### 步骤 3：别白费力气了！

![](https://i.imgur.com/0d3Cpe3.png)

我们想让土壤探测器能够长时间工作并节省电池电量，因此我们需要调整我们的代码，以便我们的湿度传感器不会消耗太多能量。

- 因为我们的电路直接连接3V的引脚，所以它一直在用电。为了替代3V引脚，我们将把电路连接到P1，并将那个引脚设置为只有在测量的时候才为高电压。这可以节省电量，同时也避免了探测器的腐蚀。 
- 我们也会降低屏幕的亮度以减少LED灯的能量消耗。
- 因为土壤湿度变化非常缓慢，所以我们不需要一直测量它。让我们在循环中添加一个5秒的暂停吧。

![](https://i.imgur.com/HJGE1a7.png)

##### 试一试吧!

- 用干燥和湿润的土壤来测试你的电路是否依然有效。 记住你需要等待10秒才能看到变化哦！

### 连接

用无线电将当前的湿度等级发送到micro:bit屏幕上。每块micro:bit将只会显示一颗LED灯。

### 湿度传感器

为了让湿度传感器生效，我们需要将程序修改为：设置无线电组4，发送设备的序列号。因为micro:bit屏幕的取值范围是`0`~`255`，所以将湿度等级的读数**除以4**。

![](https://i.imgur.com/pBkoI21.png)

### 屏幕显示
屏幕显示的代码可以在案例[无线电显示](https://makecode.microbit.org/examples/radio-dashboard)中找到。

### 设置一个micro:bit屏幕显示
将上述案例中的屏幕显示的代码下载到micro:bit。我们将用它来显示测量结果。

### 屏幕显示操作
当micro:bit面板接收到来自另一块micro:bit的信息，它就会找到一个像素点来代表那块micro:bit(记住它）。信息中的数字则被用于设置LED的亮度。

当信息没有立即被micro:bit屏幕接收到，它的像素点就会开始闪烁。然后，一段时间之后，它就会直接熄灭。

<div style="position:relative;height:0;padding-bottom:70%;overflow:hidden;"><iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="https://makecode.microbit.org/#pub:_EW72XhVrq3EH" frameborder="0" sandbox="allow-popups allow-forms allow-scripts allow-same-origin"></iframe></div>
